<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets/app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:7,&quot;tests&quot;:21,&quot;passes&quot;:21,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2025-12-27T12:22:29.965Z&quot;,&quot;end&quot;:&quot;2025-12-27T12:22:30.093Z&quot;,&quot;duration&quot;:128,&quot;testsRegistered&quot;:21,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;0995bff0-dcbb-4029-b1b3-aaa71098f1a6&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;a0ed99a4-f2e0-4bb5-8788-1bfea94f8933&quot;,&quot;title&quot;:&quot;Transfer Controller&quot;,&quot;fullFile&quot;:&quot;/home/runner/work/copilot_pgats/copilot_pgats/test/rest/controller/transferController.test.js&quot;,&quot;file&quot;:&quot;/test/rest/controller/transferController.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;ab62439b-8d12-4158-91d9-ae0526626096&quot;,&quot;title&quot;:&quot;POST /transfers&quot;,&quot;fullFile&quot;:&quot;/home/runner/work/copilot_pgats/copilot_pgats/test/rest/controller/transferController.test.js&quot;,&quot;file&quot;:&quot;/test/rest/controller/transferController.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;POST /transfers\&quot;&quot;,&quot;fullTitle&quot;:&quot;Transfer Controller POST /transfers \&quot;before all\&quot; hook in \&quot;POST /transfers\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app).post(\&quot;/users/register\&quot;).send({\n  username: \&quot;novoUsuario\&quot;,\n  password: \&quot;senha123\&quot;,\n});\nawait request(app).post(\&quot;/users/register\&quot;).send({\n  username: \&quot;novoUsuario1\&quot;,\n  password: \&quot;senha123\&quot;,\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;902484a7-a7d3-4815-ae86-c45aa9ee6ffc&quot;,&quot;parentUUID&quot;:&quot;ab62439b-8d12-4158-91d9-ae0526626096&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;POST /transfers\&quot;&quot;,&quot;fullTitle&quot;:&quot;Transfer Controller POST /transfers \&quot;before each\&quot; hook in \&quot;POST /transfers\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const respostaLogin = await request(app).post(\&quot;/users/login\&quot;).send({\n  username: \&quot;novoUsuario\&quot;,\n  password: \&quot;senha123\&quot;,\n});\ntoken = respostaLogin.body.token;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;61e8118b-d438-465d-9643-0ab377c0cf7f&quot;,&quot;parentUUID&quot;:&quot;ab62439b-8d12-4158-91d9-ae0526626096&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Realizar uma transferência para usuário não cadastrado&quot;,&quot;fullTitle&quot;:&quot;Transfer Controller POST /transfers Realizar uma transferência para usuário não cadastrado&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const response = await request(app)\n  .post(\&quot;/transfers\&quot;)\n  .set(\&quot;Authorization\&quot;, `Bearer ${token}`)\n  .send({ from: \&quot;stopa\&quot;, to: \&quot;alberto\&quot;, amount: 1000 });\nexpect(response.status).to.equal(400);\nexpect(response.body).to.have.property(\&quot;error\&quot;, \&quot;Usuário não encontrado\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;62ea208e-27d8-49f6-bb7d-4fdd0f361c64&quot;,&quot;parentUUID&quot;:&quot;ab62439b-8d12-4158-91d9-ae0526626096&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Realizar uma transferência não informando os usuários de envio e recebimento&quot;,&quot;fullTitle&quot;:&quot;Transfer Controller POST /transfers Realizar uma transferência não informando os usuários de envio e recebimento&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const response = await request(app)\n  .post(\&quot;/transfers\&quot;)\n  .set(\&quot;Authorization\&quot;, `Bearer ${token}`)\n  .send({ from: \&quot;\&quot;, to: \&quot;\&quot;, amount: 1000 });\nexpect(response.status).to.equal(400);\nexpect(response.body).to.have.property(\n  \&quot;error\&quot;,\n  \&quot;Campos obrigatórios: from, to, amount (number)\&quot;\n);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;eb64c236-88b9-4b06-ba12-390f3659d74c&quot;,&quot;parentUUID&quot;:&quot;ab62439b-8d12-4158-91d9-ae0526626096&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Realizar uma transferência com saldo insuficiente&quot;,&quot;fullTitle&quot;:&quot;Transfer Controller POST /transfers Realizar uma transferência com saldo insuficiente&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const response = await request(app)\n  .post(\&quot;/transfers\&quot;)\n  .set(\&quot;Authorization\&quot;, `Bearer ${token}`)\n  .send({ from: \&quot;novoUsuario\&quot;, to: \&quot;novoUsuario1\&quot;, amount: 20000 });\nexpect(response.status).to.equal(400);\nexpect(response.body).to.have.property(\&quot;error\&quot;, \&quot;Saldo insuficiente\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9749647f-4fbb-4677-b606-0a7cc727a95e&quot;,&quot;parentUUID&quot;:&quot;ab62439b-8d12-4158-91d9-ae0526626096&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Realizar uma transferência com valor negativo&quot;,&quot;fullTitle&quot;:&quot;Transfer Controller POST /transfers Realizar uma transferência com valor negativo&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const response = await request(app)\n  .post(\&quot;/transfers\&quot;)\n  .set(\&quot;Authorization\&quot;, `Bearer ${token}`)\n  .send({ from: \&quot;novoUsuario\&quot;, to: \&quot;novoUsuario1\&quot;, amount: -1000 });\nexpect(response.status).to.equal(400);\nexpect(response.body).to.have.property(\n  \&quot;error\&quot;,\n  \&quot;Campos obrigatórios: from, to, amount (number)\&quot;\n);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;42944337-ffac-4279-b24d-7966c01e12f8&quot;,&quot;parentUUID&quot;:&quot;ab62439b-8d12-4158-91d9-ae0526626096&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Realizar uma transferência com valor zero&quot;,&quot;fullTitle&quot;:&quot;Transfer Controller POST /transfers Realizar uma transferência com valor zero&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const response = await request(app)\n  .post(\&quot;/transfers\&quot;)\n  .set(\&quot;Authorization\&quot;, `Bearer ${token}`)\n  .send({ from: \&quot;novoUsuario\&quot;, to: \&quot;novoUsuario1\&quot;, amount: 0 });\nexpect(response.status).to.equal(400);\nexpect(response.body).to.have.property(\n  \&quot;error\&quot;,\n  \&quot;Campos obrigatórios: from, to, amount (number)\&quot;\n);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;953035d9-22ad-44ab-88d4-986c4452c6cc&quot;,&quot;parentUUID&quot;:&quot;ab62439b-8d12-4158-91d9-ae0526626096&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Deve retornar 401 se não enviar token&quot;,&quot;fullTitle&quot;:&quot;Transfer Controller POST /transfers Deve retornar 401 se não enviar token&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const response = await request(app)\n  .post(\&quot;/transfers\&quot;)\n  .send({ from: \&quot;novoUsuario\&quot;, to: \&quot;novoUsuario1\&quot;, amount: 1000 });\nexpect(response.status).to.equal(401);\nexpect(response.body).to.have.property(\&quot;error\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d92903c4-e2a7-46a8-999c-1c0d49d9ffa4&quot;,&quot;parentUUID&quot;:&quot;ab62439b-8d12-4158-91d9-ae0526626096&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Realizar uma transferência autenticada&quot;,&quot;fullTitle&quot;:&quot;Transfer Controller POST /transfers Realizar uma transferência autenticada&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const response = await request(app)\n  .post(\&quot;/transfers\&quot;)\n  .set(\&quot;Authorization\&quot;, `Bearer ${token}`)\n  .send({ from: \&quot;novoUsuario\&quot;, to: \&quot;novoUsuario1\&quot;, amount: 1000 });\nexpect(response.status).to.equal(201);\nexpect(response.body).to.have.property(\&quot;from\&quot;, \&quot;novoUsuario\&quot;);\nexpect(response.body).to.have.property(\&quot;to\&quot;, \&quot;novoUsuario1\&quot;);\nexpect(response.body).to.have.property(\&quot;amount\&quot;, 1000);\n// console.log(\&quot;Token usado:\&quot;, token);\n// console.log(\&quot;Response body:\&quot;, response.body);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;388208e8-ecc4-4633-860d-7f9647bc488d&quot;,&quot;parentUUID&quot;:&quot;ab62439b-8d12-4158-91d9-ae0526626096&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Não permite transferência &gt;= 5000 para não favorecido&quot;,&quot;fullTitle&quot;:&quot;Transfer Controller POST /transfers Não permite transferência &gt;= 5000 para não favorecido&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const response = await request(app)\n  .post(\&quot;/transfers\&quot;)\n  .set(\&quot;Authorization\&quot;, `Bearer ${token}`)\n  .send({ from: \&quot;novoUsuario\&quot;, to: \&quot;novoUsuario1\&quot;, amount: 5000 });\nexpect(response.status).to.equal(400);\nexpect(response.body).to.have.property(\n  \&quot;error\&quot;,\n  \&quot;Transferências acima de R$ 5.000,00 só para favorecidos\&quot;\n);\n// console.log(\&quot;Response body:\&quot;, response.body);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;58b242ed-317c-486c-a4be-faa28658d8bd&quot;,&quot;parentUUID&quot;:&quot;ab62439b-8d12-4158-91d9-ae0526626096&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Deve listar as transferências realizadas em memória&quot;,&quot;fullTitle&quot;:&quot;Transfer Controller POST /transfers Deve listar as transferências realizadas em memória&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const valores = [500, 1233, 1333];\nfor (const amount of valores) {\n  await request(app)\n    .post(\&quot;/transfers\&quot;)\n    .set(\&quot;Authorization\&quot;, `Bearer ${token}`)\n    .send({ from: \&quot;novoUsuario\&quot;, to: \&quot;novoUsuario1\&quot;, amount });\n}\nconst response = await request(app)\n  .get(\&quot;/transfers\&quot;)\n  .set(\&quot;Authorization\&quot;, `Bearer ${token}`);\n// console.log(\&quot;Listagem de transferências:\&quot;, response.body);\nexpect(response.status).to.equal(200);\nexpect(response.body).to.be.an(\&quot;array\&quot;);\nfor (const amount of valores) {\n  expect(\n    response.body.some(\n      (t) =&gt;\n        t.from === \&quot;novoUsuario\&quot; &amp;&amp;\n        t.to === \&quot;novoUsuario1\&quot; &amp;&amp;\n        t.amount === amount\n    )\n  ).to.be.true;\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;29cf234e-80d4-46fe-b338-e513cd257208&quot;,&quot;parentUUID&quot;:&quot;ab62439b-8d12-4158-91d9-ae0526626096&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;62ea208e-27d8-49f6-bb7d-4fdd0f361c64&quot;,&quot;eb64c236-88b9-4b06-ba12-390f3659d74c&quot;,&quot;9749647f-4fbb-4677-b606-0a7cc727a95e&quot;,&quot;42944337-ffac-4279-b24d-7966c01e12f8&quot;,&quot;953035d9-22ad-44ab-88d4-986c4452c6cc&quot;,&quot;d92903c4-e2a7-46a8-999c-1c0d49d9ffa4&quot;,&quot;388208e8-ecc4-4633-860d-7f9647bc488d&quot;,&quot;58b242ed-317c-486c-a4be-faa28658d8bd&quot;,&quot;29cf234e-80d4-46fe-b338-e513cd257208&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:32,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;d95c8550-57a4-4480-956b-b0d46f7e9fe8&quot;,&quot;title&quot;:&quot;Transfer Controller - Unit&quot;,&quot;fullFile&quot;:&quot;/home/runner/work/copilot_pgats/copilot_pgats/test/rest/controller/transferController.unit.test.js&quot;,&quot;file&quot;:&quot;/test/rest/controller/transferController.unit.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;Transfer Controller - Unit\&quot;&quot;,&quot;fullTitle&quot;:&quot;Transfer Controller - Unit \&quot;before all\&quot; hook in \&quot;Transfer Controller - Unit\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app).post(\&quot;/users/register\&quot;).send({\n  username: \&quot;novoUsuario\&quot;,\n  password: \&quot;senha123\&quot;,\n});\nawait request(app).post(\&quot;/users/register\&quot;).send({\n  username: \&quot;novoUsuario1\&quot;,\n  password: \&quot;senha123\&quot;,\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;00ff2736-aad8-4c02-bb98-d1252ea935e9&quot;,&quot;parentUUID&quot;:&quot;d95c8550-57a4-4480-956b-b0d46f7e9fe8&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;Transfer Controller - Unit\&quot;&quot;,&quot;fullTitle&quot;:&quot;Transfer Controller - Unit \&quot;before each\&quot; hook in \&quot;Transfer Controller - Unit\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const respostaLogin = await request(app).post(\&quot;/users/login\&quot;).send({\n  username: \&quot;novoUsuario\&quot;,\n  password: \&quot;senha123\&quot;,\n});\ntoken = respostaLogin.body.token;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f6891f72-f5b2-4502-9daf-1306c34ff565&quot;,&quot;parentUUID&quot;:&quot;d95c8550-57a4-4480-956b-b0d46f7e9fe8&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after each\&quot; hook in \&quot;Transfer Controller - Unit\&quot;&quot;,&quot;fullTitle&quot;:&quot;Transfer Controller - Unit \&quot;after each\&quot; hook in \&quot;Transfer Controller - Unit\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;sinon.restore();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8cd2faf6-2704-4fc2-a061-6b7a8bd98fc9&quot;,&quot;parentUUID&quot;:&quot;d95c8550-57a4-4480-956b-b0d46f7e9fe8&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;Deve retornar erro do service ao tentar transferir (stub)&quot;,&quot;fullTitle&quot;:&quot;Transfer Controller - Unit Deve retornar erro do service ao tentar transferir (stub)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;sinon.stub(transferService, \&quot;transfer\&quot;).throws(new Error(\&quot;Erro simulado\&quot;));\nconst response = await request(app)\n  .post(\&quot;/transfers\&quot;)\n  .set(\&quot;Authorization\&quot;, `Bearer ${token}`)\n  .send({ from: \&quot;novoUsuario\&quot;, to: \&quot;novoUsuario1\&quot;, amount: 1000 });\nexpect(response.status).to.equal(400);\nexpect(response.body).to.have.property(\&quot;error\&quot;, \&quot;Erro simulado\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1bc68f2f-0de6-444a-aba8-a83654642a6d&quot;,&quot;parentUUID&quot;:&quot;d95c8550-57a4-4480-956b-b0d46f7e9fe8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Deve chamar o service de transferência uma vez (spy)&quot;,&quot;fullTitle&quot;:&quot;Transfer Controller - Unit Deve chamar o service de transferência uma vez (spy)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const spy = sinon.spy(transferService, \&quot;transfer\&quot;);\nawait request(app)\n  .post(\&quot;/transfers\&quot;)\n  .set(\&quot;Authorization\&quot;, `Bearer ${token}`)\n  .send({ from: \&quot;novoUsuario\&quot;, to: \&quot;novoUsuario1\&quot;, amount: 1000 });\nexpect(spy.calledOnce).to.be.true;\nspy.restore();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;63667168-4479-422e-b8c3-5e703daaf88d&quot;,&quot;parentUUID&quot;:&quot;d95c8550-57a4-4480-956b-b0d46f7e9fe8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Deve simular retorno de sucesso do service (stub)&quot;,&quot;fullTitle&quot;:&quot;Transfer Controller - Unit Deve simular retorno de sucesso do service (stub)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const fakeTransfer = {\n  from: \&quot;novoUsuario\&quot;,\n  to: \&quot;novoUsuario1\&quot;,\n  amount: 123,\n  date: new Date(),\n};\nsinon.stub(transferService, \&quot;transfer\&quot;).returns(fakeTransfer);\nconst response = await request(app)\n  .post(\&quot;/transfers\&quot;)\n  .set(\&quot;Authorization\&quot;, `Bearer ${token}`)\n  .send({ from: \&quot;novoUsuario\&quot;, to: \&quot;novoUsuario1\&quot;, amount: 123 });\nexpect(response.status).to.equal(201);\nexpect(response.body).to.include({\n  from: \&quot;novoUsuario\&quot;,\n  to: \&quot;novoUsuario1\&quot;,\n  amount: 123,\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;539fb163-10ad-4295-8181-eb3674c57533&quot;,&quot;parentUUID&quot;:&quot;d95c8550-57a4-4480-956b-b0d46f7e9fe8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Deve usar mock para esperar chamada do service&quot;,&quot;fullTitle&quot;:&quot;Transfer Controller - Unit Deve usar mock para esperar chamada do service&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const mock = sinon.mock(transferService);\nmock\n  .expects(\&quot;transfer\&quot;)\n  .once()\n  .withArgs({ from: \&quot;novoUsuario\&quot;, to: \&quot;novoUsuario1\&quot;, amount: 555 });\nawait request(app)\n  .post(\&quot;/transfers\&quot;)\n  .set(\&quot;Authorization\&quot;, `Bearer ${token}`)\n  .send({ from: \&quot;novoUsuario\&quot;, to: \&quot;novoUsuario1\&quot;, amount: 555 });\nmock.verify();\nmock.restore();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fdfbaf7f-1d09-404b-b4f9-54ad12d62441&quot;,&quot;parentUUID&quot;:&quot;d95c8550-57a4-4480-956b-b0d46f7e9fe8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Não permite transferência &gt;= 5000 para não favorecido (unit)&quot;,&quot;fullTitle&quot;:&quot;Transfer Controller - Unit Não permite transferência &gt;= 5000 para não favorecido (unit)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;sinon\n  .stub(transferService, \&quot;transfer\&quot;)\n  .throws(\n    new Error(\&quot;Transferências acima de R$ 5.000,00 só para favorecidos\&quot;)\n  );\nconst response = await request(app)\n  .post(\&quot;/transfers\&quot;)\n  .set(\&quot;Authorization\&quot;, `Bearer ${token}`)\n  .send({ from: \&quot;novoUsuario\&quot;, to: \&quot;novoUsuario1\&quot;, amount: 5000 });\nexpect(response.status).to.equal(400);\nexpect(response.body).to.have.property(\n  \&quot;error\&quot;,\n  \&quot;Transferências acima de R$ 5.000,00 só para favorecidos\&quot;\n);\n// console.log(\&quot;Response body:\&quot;, response.body);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2cf44852-44d7-453d-98ec-a773992ed6aa&quot;,&quot;parentUUID&quot;:&quot;d95c8550-57a4-4480-956b-b0d46f7e9fe8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1bc68f2f-0de6-444a-aba8-a83654642a6d&quot;,&quot;63667168-4479-422e-b8c3-5e703daaf88d&quot;,&quot;539fb163-10ad-4295-8181-eb3674c57533&quot;,&quot;fdfbaf7f-1d09-404b-b4f9-54ad12d62441&quot;,&quot;2cf44852-44d7-453d-98ec-a773992ed6aa&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:15,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;3d040db4-4721-4aa8-848f-83c67ab486f0&quot;,&quot;title&quot;:&quot;User Controller&quot;,&quot;fullFile&quot;:&quot;/home/runner/work/copilot_pgats/copilot_pgats/test/rest/controller/userController.test.js&quot;,&quot;file&quot;:&quot;/test/rest/controller/userController.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;0820be62-2cb5-417b-8342-f05567d615e7&quot;,&quot;title&quot;:&quot;POST /users/register&quot;,&quot;fullFile&quot;:&quot;/home/runner/work/copilot_pgats/copilot_pgats/test/rest/controller/userController.test.js&quot;,&quot;file&quot;:&quot;/test/rest/controller/userController.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Deve registrar um novo usuário com sucesso&quot;,&quot;fullTitle&quot;:&quot;User Controller POST /users/register Deve registrar um novo usuário com sucesso&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const response = await request(app)\n  .post(\&quot;/users/register\&quot;)\n  .send({ username: \&quot;usuarioTeste\&quot;, password: \&quot;senha123\&quot; });\nexpect(response.status).to.equal(201);\nexpect(response.body).to.have.property(\&quot;username\&quot;, \&quot;usuarioTeste\&quot;);\nexpect(response.body).to.have.property(\&quot;favorecidos\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b64712bd-e425-46d0-a83b-3e3fd1a4c88b&quot;,&quot;parentUUID&quot;:&quot;0820be62-2cb5-417b-8342-f05567d615e7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Não deve registrar usuário sem username ou password&quot;,&quot;fullTitle&quot;:&quot;User Controller POST /users/register Não deve registrar usuário sem username ou password&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const response = await request(app)\n  .post(\&quot;/users/register\&quot;)\n  .send({ username: \&quot;\&quot;, password: \&quot;\&quot; });\nexpect(response.status).to.equal(400);\nexpect(response.body).to.have.property(\n  \&quot;error\&quot;,\n  \&quot;Usuário e senha são obrigatórios\&quot;\n);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dfbfcc73-2929-46b8-9673-1cac4a30840b&quot;,&quot;parentUUID&quot;:&quot;0820be62-2cb5-417b-8342-f05567d615e7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Não deve registrar usuário duplicado&quot;,&quot;fullTitle&quot;:&quot;User Controller POST /users/register Não deve registrar usuário duplicado&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n  .post(\&quot;/users/register\&quot;)\n  .send({ username: \&quot;usuarioDuplicado\&quot;, password: \&quot;senha123\&quot; });\nconst response = await request(app)\n  .post(\&quot;/users/register\&quot;)\n  .send({ username: \&quot;usuarioDuplicado\&quot;, password: \&quot;senha123\&quot; });\nexpect(response.status).to.equal(400);\nexpect(response.body).to.have.property(\&quot;error\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8838d3ac-bb3f-4313-b114-306df13b61a1&quot;,&quot;parentUUID&quot;:&quot;0820be62-2cb5-417b-8342-f05567d615e7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b64712bd-e425-46d0-a83b-3e3fd1a4c88b&quot;,&quot;dfbfcc73-2929-46b8-9673-1cac4a30840b&quot;,&quot;8838d3ac-bb3f-4313-b114-306df13b61a1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;2b77cc60-840d-4f5f-9a27-0531e5afeff0&quot;,&quot;title&quot;:&quot;POST /users/login&quot;,&quot;fullFile&quot;:&quot;/home/runner/work/copilot_pgats/copilot_pgats/test/rest/controller/userController.test.js&quot;,&quot;file&quot;:&quot;/test/rest/controller/userController.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;POST /users/login\&quot;&quot;,&quot;fullTitle&quot;:&quot;User Controller POST /users/login \&quot;before all\&quot; hook in \&quot;POST /users/login\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await request(app)\n  .post(\&quot;/users/register\&quot;)\n  .send({ username: \&quot;usuarioLogin\&quot;, password: \&quot;senha123\&quot; });&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;319b2754-83b1-4680-a6e7-4f4a6829a85a&quot;,&quot;parentUUID&quot;:&quot;2b77cc60-840d-4f5f-9a27-0531e5afeff0&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Deve fazer login com sucesso e retornar token&quot;,&quot;fullTitle&quot;:&quot;User Controller POST /users/login Deve fazer login com sucesso e retornar token&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const response = await request(app)\n  .post(\&quot;/users/login\&quot;)\n  .send({ username: \&quot;usuarioLogin\&quot;, password: \&quot;senha123\&quot; });\nexpect(response.status).to.equal(200);\nexpect(response.body).to.have.property(\&quot;token\&quot;);\nexpect(response.body).to.have.property(\&quot;username\&quot;, \&quot;usuarioLogin\&quot;);\nexpect(response.body).to.have.property(\&quot;favorecidos\&quot;);\nexpect(response.body).to.have.property(\&quot;saldo\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;111b8ee3-aa78-4e90-a1c6-fb7ae272fc2a&quot;,&quot;parentUUID&quot;:&quot;2b77cc60-840d-4f5f-9a27-0531e5afeff0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Não deve logar com senha errada&quot;,&quot;fullTitle&quot;:&quot;User Controller POST /users/login Não deve logar com senha errada&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const response = await request(app)\n  .post(\&quot;/users/login\&quot;)\n  .send({ username: \&quot;usuarioLogin\&quot;, password: \&quot;senhaErrada\&quot; });\nexpect(response.status).to.equal(401);\nexpect(response.body).to.have.property(\&quot;error\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;24b54b57-64a8-4c57-91a2-4d2a56e2d4a6&quot;,&quot;parentUUID&quot;:&quot;2b77cc60-840d-4f5f-9a27-0531e5afeff0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;Não deve logar sem username ou password&quot;,&quot;fullTitle&quot;:&quot;User Controller POST /users/login Não deve logar sem username ou password&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const response = await request(app)\n  .post(\&quot;/users/login\&quot;)\n  .send({ username: \&quot;\&quot;, password: \&quot;\&quot; });\nexpect(response.status).to.equal(400);\nexpect(response.body).to.have.property(\n  \&quot;error\&quot;,\n  \&quot;Usuário e senha são obrigatórios\&quot;\n);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;df09d571-0fb6-4d3c-a51f-65adb3975357&quot;,&quot;parentUUID&quot;:&quot;2b77cc60-840d-4f5f-9a27-0531e5afeff0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;111b8ee3-aa78-4e90-a1c6-fb7ae272fc2a&quot;,&quot;24b54b57-64a8-4c57-91a2-4d2a56e2d4a6&quot;,&quot;df09d571-0fb6-4d3c-a51f-65adb3975357&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000},{&quot;uuid&quot;:&quot;c0d151b9-b8e4-4367-bb3c-c41e773be232&quot;,&quot;title&quot;:&quot;GET /users&quot;,&quot;fullFile&quot;:&quot;/home/runner/work/copilot_pgats/copilot_pgats/test/rest/controller/userController.test.js&quot;,&quot;file&quot;:&quot;/test/rest/controller/userController.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;Deve listar todos os usuários cadastrados&quot;,&quot;fullTitle&quot;:&quot;User Controller GET /users Deve listar todos os usuários cadastrados&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const response = await request(app).get(\&quot;/users\&quot;);\nexpect(response.status).to.equal(200);\nexpect(response.body).to.be.an(\&quot;array\&quot;);\nexpect(response.body.length).to.be.greaterThan(0);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;460790e6-5907-4fa4-8ccc-65a03300fcfd&quot;,&quot;parentUUID&quot;:&quot;c0d151b9-b8e4-4367-bb3c-c41e773be232&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;460790e6-5907-4fa4-8ccc-65a03300fcfd&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:10000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:10000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;11.7.2&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.4&quot;},&quot;marge&quot;:{&quot;version&quot;:&quot;6.3.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;reportDir&quot;:&quot;mochawesome-report&quot;,&quot;reportTitle&quot;:&quot;copilot_pgats&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;mochawesome-report/assets&quot;,&quot;jsonFile&quot;:&quot;/home/runner/work/copilot_pgats/copilot_pgats/mochawesome-report/mochawesome.json&quot;,&quot;htmlFile&quot;:&quot;/home/runner/work/copilot_pgats/copilot_pgats/mochawesome-report/mochawesome.html&quot;}"><div id="report"></div><script src="assets/app.js"></script></body></html>